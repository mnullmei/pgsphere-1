-- conversions to / from healpix indexing

CREATE FUNCTION nside2order(bigint)
RETURNS integer
AS 'MODULE_PATHNAME', 'pg_nside2order'
LANGUAGE C IMMUTABLE STRICT;
COMMENT ON FUNCTION nside2order(bigint) IS
'returns integer part of base-two logarithm of argument for powers of two up to 29, NULL otherwise';

CREATE FUNCTION order2nside(integer)
RETURNS bigint
AS 'MODULE_PATHNAME', 'pg_order2nside'
LANGUAGE C IMMUTABLE STRICT;
COMMENT ON FUNCTION order2nside(integer) IS
'returns power of two for non-negative values up to 29, NULL otherwise';

CREATE FUNCTION nside2npix(bigint)
RETURNS bigint
AS 'MODULE_PATHNAME', 'pg_nside2npix'
LANGUAGE C IMMUTABLE STRICT;
COMMENT ON FUNCTION nside2npix(bigint) IS
'returns the number of healpix elements for the nside parameter, 12 * nside ^ 2, NULL for invalid input';

CREATE FUNCTION npix2nside(bigint)
RETURNS bigint
AS 'MODULE_PATHNAME', 'pg_npix2nside'
LANGUAGE C IMMUTABLE STRICT;
COMMENT ON FUNCTION npix2nside(bigint) IS
'returns the nside parameter from the number of healpix elements npix, NULL for invalid input';

CREATE FUNCTION healpix_nest(integer, spoint)
RETURNS bigint
AS 'MODULE_PATHNAME'
LANGUAGE C IMMUTABLE STRICT;
COMMENT ON FUNCTION healpix_nest(integer, spoint) IS
'nested healpix index of a spherical point for the specified integer level (first argument)';

CREATE FUNCTION healpix_ring(integer, spoint)
RETURNS bigint
AS 'MODULE_PATHNAME'
LANGUAGE C IMMUTABLE STRICT;
COMMENT ON FUNCTION healpix_ring(integer, spoint) IS
'healpix ring index of a spherical point for the specified integer level (first argument)';

CREATE FUNCTION centre_of_healpix_nest(integer, bigint)
RETURNS spoint
AS 'MODULE_PATHNAME', 'inv_healpix_nest'
LANGUAGE C IMMUTABLE STRICT;
COMMENT ON FUNCTION healpix_nest(integer, spoint) IS
'spherical point designating the centre of a nested healpix element for the specified integer level (first argument)';

CREATE FUNCTION centre_of_healpix_ring(integer, bigint)
RETURNS spoint
AS 'MODULE_PATHNAME', 'inv_healpix_ring'
LANGUAGE C IMMUTABLE STRICT;
COMMENT ON FUNCTION healpix_ring(integer, spoint) IS
'spherical point designating the centre of a ring healpix element for the specified integer level (first argument)';

CREATE FUNCTION center_of_healpix_nest(integer, bigint)
RETURNS spoint
AS 'MODULE_PATHNAME', 'inv_healpix_nest'
LANGUAGE C IMMUTABLE STRICT;
COMMENT ON FUNCTION healpix_nest(integer, spoint) IS
'spherical point designating the center of a nested healpix element for the specified integer level (first argument)';

CREATE FUNCTION center_of_healpix_ring(integer, bigint)
RETURNS spoint
AS 'MODULE_PATHNAME', 'inv_healpix_ring'
LANGUAGE C IMMUTABLE STRICT;
COMMENT ON FUNCTION healpix_ring(integer, spoint) IS
'spherical point designating the center of a ring healpix element for the specified integer level (first argument)';
